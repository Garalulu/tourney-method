# Test Design: Story 1.1 - Project & Database Setup

Date: 2025-09-04  
Designer: Quinn (Test Architect)  
Story ID: 1.1

## Test Strategy Overview - MINIMAL APPROACH

- **Total test scenarios**: 6 (minimal essential coverage)
- **Unit tests**: 1 (17%)
- **Integration tests**: 3 (50%) 
- **E2E tests**: 2 (33%)
- **Priority distribution**: P0: 4, P1: 2, P2: 0

**Philosophy**: Test only what's critical for this foundational story. Avoid over-testing setup activities that are validated by subsequent stories.

## Test Scenarios by Acceptance Criteria

### AC1: Git Repository Initialization

| ID           | Level       | Priority | Test                           | Justification                    |
|--------------|-------------|----------|--------------------------------|----------------------------------|
| 1.1-INT-001  | Integration | P1       | Git repository functional      | Basic verification only          |

**Minimal Test**: Verify `.git` exists and basic git operations work. Skip detailed git config testing.

### AC2: PHP Application Structure  

| ID           | Level       | Priority | Test                           | Justification                    |
|--------------|-------------|----------|--------------------------------|----------------------------------|
| 1.1-E2E-001  | E2E         | P0       | Application serves basic page  | Only test that matters to users  |

**Minimal Test**: App starts and serves a page. Directory structure will be validated implicitly by Story 1.2 when it tries to use the structure.

### AC3: Database Schema Creation

| ID           | Level       | Priority | Test                           | Justification                    |
|--------------|-------------|----------|--------------------------------|----------------------------------|
| 1.1-INT-002  | Integration | P0       | Database initializes correctly | Core data foundation             |
| 1.1-UNIT-001 | Unit        | P0       | Schema validation essential    | Prevent corrupted schema         |
| 1.1-INT-003  | Integration | P0       | Database security configured   | Critical security requirement    |
| 1.1-E2E-002  | E2E         | P1       | Database not web-accessible    | Security verification            |

## Minimal Test Implementation

### P0 Tests (Must Have)

**1.1-INT-002: Database Initialization**
```php
testDatabaseInitialization() {
  // Schema file exists and is readable
  // Database file created successfully  
  // Basic tables exist (users, tournaments, system_logs)
  // Can perform simple SELECT query
}
```

**1.1-UNIT-001: Schema Validation** 
```php
testSchemaValidation() {
  // Required tables present
  // Foreign keys properly defined
  // Essential indexes exist
}
```

**1.1-INT-003: Database Security**
```php
testDatabaseSecurity() {
  // Database file outside web root
  // App Platform security protection in place
  // File permissions restrictive (600)
}
```

**1.1-E2E-001: Application Startup**
```php
testApplicationStartup() {
  // App serves response without errors
  // Database connection works
  // Basic functionality accessible
}
```

### P1 Tests (Should Have)

**1.1-INT-001: Git Functional**
```php
testGitFunctional() {
  // .git directory exists
  // Can add/commit files
  // .gitignore working
}
```

**1.1-E2E-002: Security Isolation**
```php
testDatabaseNotAccessible() {
  // Direct HTTP access to database returns 403/404
  // No database content served via web
}
```

## What We're NOT Testing (Intentionally Minimal)

### Avoided Over-Testing
- ❌ Detailed directory structure validation (will be tested by usage)
- ❌ Individual git commands (git works or it doesn't)
- ❌ Complex schema constraint testing (validated by business logic tests later)
- ❌ Performance testing (premature for foundation)
- ❌ Detailed error handling (will be tested when errors actually matter)
- ❌ Configuration validation (tested when configuration is used)

### Deferred to Later Stories
- **Admin Login (1.2)**: Will validate authentication setup
- **Parser (1.3)**: Will validate database write operations  
- **Admin UI (1.5)**: Will validate database read operations
- **Error Logging (1.7)**: Will validate logging functionality

## Risk Coverage (Essential Only)

- **SEC-001 (Database Security)**: ✅ 1.1-INT-003, 1.1-E2E-002
- **TECH-001 (Schema Design)**: ✅ 1.1-UNIT-001, 1.1-INT-002  
- **Other risks**: Deferred to stories that actually use the functionality

## Execution Strategy

### Fast Feedback Loop
1. **1.1-UNIT-001** (30 seconds) - Schema validation
2. **1.1-INT-002** (1 minute) - Database initialization  
3. **1.1-INT-003** (30 seconds) - Security configuration
4. **1.1-E2E-001** (1 minute) - Application startup

### Full Validation  
5. **1.1-INT-001** (30 seconds) - Git functionality
6. **1.1-E2E-002** (1 minute) - Security isolation

**Total execution time**: ~4 minutes (acceptable for foundation validation)

## Success Criteria (Minimal)

### Story 1.1 Complete When:
- ✅ Application starts without errors
- ✅ Database schema created and functional
- ✅ Database secured outside web root  
- ✅ Git repository functional for development

### Explicitly NOT Required:
- Comprehensive error handling testing
- Performance benchmarks
- Detailed configuration validation
- Complex integration scenarios

## Gate Integration

```yaml
test_design:
  scenarios_total: 6
  approach: minimal_essential
  by_level:
    unit: 1
    integration: 3  
    e2e: 2
  by_priority:
    p0: 4
    p1: 2
    p2: 0
  coverage_philosophy: "Test foundation, not implementation details"
```

## Key Principle Applied

**"Test the contract, not the implementation"** - We're testing that Story 1.1 provides a working foundation for subsequent stories, not every possible detail of the setup process.

This minimal approach ensures we catch critical issues without over-engineering tests for setup activities that will be thoroughly validated by actual feature usage in later stories.