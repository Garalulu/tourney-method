# Story 1.1: Project & Database Setup

## Status
Draft

## Story
**As a** Developer,
**I want** The basic file structure, repository, and an initial SQLite database schema created,
**so that** I have a foundational codebase to start building features on.

## Acceptance Criteria
1. A Git repository is initialized.
2. A basic PHP application structure exists (e.g., folders for public assets, backend logic, templates).
3. An SQLite database file is created with the initial tables (`tournaments`, `users`, `system_logs`, etc.) and schema.

## Tasks / Subtasks

- [ ] Initialize Git Repository (AC: 1)
  - [ ] Run `git init` in project root
  - [ ] Create initial `.gitignore` file with appropriate exclusions
  - [ ] Create initial commit with basic project structure

- [ ] Create Complete Directory Structure (AC: 2)
  - [ ] Create `public/` directory (web root)
    - [ ] Create `public/admin/` subdirectory for admin interface
    - [ ] Create `public/api/` subdirectory for REST API endpoints
    - [ ] Create `public/assets/` subdirectory with css/, js/, images/ folders
  - [ ] Create `src/` directory (PHP application logic)
    - [ ] Create `src/config/` for configuration files
    - [ ] Create `src/models/` for data models
    - [ ] Create `src/services/` for business logic
    - [ ] Create `src/repositories/` for data access layer
    - [ ] Create `src/utils/` for utility functions
    - [ ] Create `src/templates/` for PHP view templates with layouts/, components/, pages/, admin/ subdirectories
  - [ ] Create `data/` directory
    - [ ] Create `data/database/` for SQLite database file
    - [ ] Create `data/migrations/` for database migration scripts
    - [ ] Create `data/seeds/` for development seed data
  - [ ] Create `scripts/` directory
    - [ ] Create `scripts/parser/` for parsing scripts
    - [ ] Create `scripts/maintenance/` for maintenance utilities
    - [ ] Create `scripts/setup/` for setup scripts
  - [ ] Create `tests/` directory with unit/, integration/, fixtures/ subdirectories
  - [ ] Create `config/` directory for environment configuration
  - [ ] Create `logs/` directory for application logs

- [ ] Create Database Schema and Files (AC: 3)
  - [ ] Copy `data/schema.sql` to `data/database/schema.sql`
  - [ ] Create empty SQLite database file at `data/database/tournaments.db`
  - [ ] Execute schema.sql against the database to create all tables
  - [ ] Verify tables are created: users, tournaments, system_logs, sessions, api_rate_limits
  - [ ] Test database connectivity and basic queries

- [ ] Create Essential Configuration Files (AC: 2)
  - [ ] Create `public/.htaccess` with security headers and URL rewriting
  - [ ] Create `composer.json` with minimal PHP dependencies
  - [ ] Create basic `README.md` with project description
  - [ ] Create `config/development.php` configuration template
  - [ ] Create `.env.example` file for environment variables

- [ ] Create Unit Tests for Database Setup (Testing)
  - [ ] Create test to verify all required tables exist
  - [ ] Create test to verify database schema constraints
  - [ ] Create test to verify database connection configuration

## Dev Notes

### Project Structure Overview
[Source: architecture-progress.md#unified-project-structure]

The project follows a **monorepo organization** with functional separation and vanilla PHP structure optimized for Korean deployment. The complete directory structure is defined in the architecture document with specific paths for all components.

**Key Structural Principles:**
- **Security by Default**: Sensitive files (src/, data/, scripts/, config/, logs/) are outside the web root (public/)
- **Clear Separation**: Public vs private code organization with proper .htaccess restrictions
- **PSR-4 Autoloading**: src/ directory follows PSR-4 namespace structure
- **Repository Pattern**: Data access separated from business logic

### Database Schema Details
[Source: data/schema.sql]

The SQLite database uses the following core tables:
- **users**: Admin authentication with osu_id, username, is_admin flag
- **tournaments**: Main tournament data with status workflow (pending_review â†’ approved)
- **system_logs**: Error tracking and auditing with proper log levels
- **sessions**: Secure session management with CSRF protection
- **api_rate_limits**: API rate limiting by endpoint and IP

**Security Features:**
- PRAGMA foreign_keys enabled
- WAL journal mode for better concurrency
- Proper CHECK constraints on all fields
- Indexes optimized for common query patterns

### File Permissions and Security
[Source: architecture-progress.md#security-file-structure]

**Access Control Strategy:**
- Web Root (public/): 644 for files, 755 for directories
- Application Code (src/): 600 for files, 700 for directories  
- Database File: 600 permissions, owned by web server user
- .htaccess rules deny access to sensitive directories (src, data, scripts, config, logs)

### Technology Stack
[Source: architecture-progress.md#tech-stack]

- **Backend**: Vanilla PHP (no frameworks)
- **Database**: SQLite with evolution path to PostgreSQL
- **Frontend**: jQuery + Pico.css
- **Deployment**: DigitalOcean Singapore for Korean market optimization
- **Version Control**: Git with monorepo structure

### Testing

**Test Structure and Standards:**
[Source: architecture-progress.md#unified-project-structure]

- **Test Location**: `tests/` directory with unit/, integration/, fixtures/ subdirectories
- **Test Framework**: PHPUnit (configured via phpunit.xml)
- **Test Categories**:
  - Unit tests for individual components (models, services, utilities)
  - Integration tests for database operations and API endpoints
  - Fixtures for sample data and test scenarios

**Testing Requirements for This Story:**
- Database connectivity tests
- Schema validation tests (verify all tables and constraints exist)
- Directory structure validation tests
- Git repository initialization verification tests

**File Naming Convention**: {ComponentName}Test.php (e.g., DatabaseTest.php, TournamentRepositoryTest.php)

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-04 | 1.0 | Initial story creation | Scrum Master |

## Dev Agent Record

*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References  
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results

*Results from QA Agent review will be added here after implementation*